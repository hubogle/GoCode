# äºŒåˆ†æŸ¥æ‰¾

[äºŒåˆ†æŸ¥æ‰¾æ€»ç»“](https://leetcode-cn.com/problems/find-first-and-last-position-of-element-in-sorted-array/solution/yi-wen-dai-ni-gao-ding-er-fen-cha-zhao-j-ymwl/)

ä¸¤ä¸ªæ˜“é”™ç‚¹

1. è®¡ç®— `mid` ä½¿ç”¨ `left + ((right - left)>>1)` é˜²æ­¢æ•°å€¼æº¢å‡ºï¼›
2. åŒºé—´é€‰æ‹© `while(left < right)` or `while(left <= right)`ï¼›
3. åˆ¤æ–­é€‰æ‹© `right = mid` or `right = mid - 1`ï¼›
4. éœ€è¦è€ƒè™‘å…ƒç´ æ˜¯å¦ä¸ºé€’å¢ï¼Œæœ€å¤§å€¼å’Œæœ€å°å€¼çš„åˆ¤æ–­ï¼Œæ•°ç»„æ˜¯å¦ä¸ºç©ºï¼›
5. äºŒåˆ†æŸ¥æ‰¾æœ‰å¾ˆå¤šå˜ç§ï¼Œä¸è¦ä¸€å‘³è¿½æ±‚ä»£ç ç®€æ´ï¼Œè€Œå¯¼è‡´ä¸å¥½ç†è§£ï¼›
6. åªéœ€è¦è€ƒè™‘åˆ°äºŒåˆ†æŸ¥æ‰¾ä¸´ç•Œå€¼çš„æƒ…å†µåˆ¤å®šï¼Œåˆ’åˆ†å¥½å‡ºç°çš„æƒ…å†µï¼›

åŒºé—´çš„å®šä¹‰æ˜¯ä¸å˜é‡ã€‚åœ¨äºŒåˆ†æŸ¥æ‰¾è¿‡ç¨‹ä¿æŒä¸å˜é‡ï¼Œ`while` å¾ªç¯ä¸­ï¼Œæ¯æ¬¡è¾¹ç•Œå¤„ç†æ ¹æ®åŒºé—´çš„å®šä¹‰æ¥æ“ä½œï¼Œè¿™æ˜¯ **å¾ªç¯ä¸å˜é‡** è§„åˆ™ã€‚

## äºŒåˆ†æŸ¥æ‰¾å†™æ³•ä¸€

å®šä¹‰å·¦é—­å³é—­åŒºé—´ `[left, right]`ï¼Œç‰¹ç‚¹æ˜¯ï¼š

1. `left, right` ç›¸ç­‰çš„æƒ…å†µï¼Œæ”¹åŒºé—´æ˜¯æœ‰æ„ä¹‰çš„ï¼Œæ‰€ä»¥ `while(left <= right)`ã€‚
2. `nums[mid] > target`ï¼Œæ›´æ–°æœç´¢èŒƒå›´å³ä¸‹æ ‡ `right = mid - 1`ï¼Œå› ä¸º `nums[mid]` ä¸æ˜¯ç›®æ ‡å€¼ï¼Œæ‰€ä»¥å·¦åŒºé—´ç»“æŸä¸‹æ ‡ä¸º `mid - 1`ã€‚

```go
package main

func search(nums []int, target int) int {
	l, r := 0, len(nums)-1
	for l <= r { // [l,r] å·¦é—­å³é—­åŒºé—´
		mid := l + ((r - l) >> 2)
		if nums[mid] > target {
			r = mid - 1 // target åœ¨å·¦åŒºé—´
		} else if nums[mid] < target {
			l = mid + 1
		} else {
			return mid
		}
	}
	return -1
}
```

## äºŒåˆ†æŸ¥æ‰¾å†™æ³•äºŒ

å®šä¹‰å·¦é—­å³å¼€åŒºé—´ `[left, right)`ï¼Œç‰¹ç‚¹æ˜¯ï¼š

1. `left, right` ç›¸ç­‰çš„æƒ…å†µæ˜¯æ— æ„ä¹‰çš„ï¼Œæ‰€ä»¥ `while(left < right)`ã€‚
2. `nums[mid] > target` ï¼Œæ›´æ–°æœç´¢èŒƒå›´å³ä¸‹æ ‡ `right = mid`ï¼Œå› ä¸ºå½“å‰ `nums[mid]` ä¸æ˜¯ç›®æ ‡å€¼ï¼Œå·¦åŒºé—´ä¸ºå·¦é—­å³å¼€æ‰€ä»¥ç»“æŸä¸‹æ ‡ä¸º `mid`ã€‚

```go
package main

func search(nums []int, target int) int {
	l, r := 0, len(nums)-1
	if l < r { // [l, r) å·¦é—­å³å¼€åŒºé—´
		mid := l + ((r - l) >> 2)
		if nums[mid] > target {
			r = mid // target åœ¨å·¦åŒºé—´ï¼Œå·¦é—­å³å¼€
		} else if nums[mid] < target {
			l = mid + 1
		} else {
			return mid
		}
	}
	return -1
}
```

## å˜ç§ï¼š35.æœç´¢æ’å…¥ä½ç½®

é—®é¢˜å˜ä¸ºï¼šåœ¨ä¸€ä¸ªæœ‰åºæ•°ç»„ä¸­æ‰¾ç¬¬ä¸€ä¸ªå¤§äºç­‰äº target çš„ä¸‹æ ‡ã€‚
`mid` ä¸ºæœ€ç»ˆç¬¦åˆæ¡ä»¶çš„ä¸€ä¸ªï¼Œ`mid+1` å°±æ˜¯å¤§äº `target` çš„ç´¢å¼•ä½ç½®ï¼Œ`mid-1` å°±æ˜¯å°äº `target` çš„ä½ç½®ã€‚ ğŸ¤”æœ€åä¸€ä¸ªä¸´ç•Œå€¼çš„æ¡ä»¶æƒ…å†µã€‚

```go
package main

func searchInsert(nums []int, target int) int {
	l, r := 0, len(nums)-1
	for l <= r {
		mid := l + ((r - l) >> 1)
		if nums[mid] == target {
			return mid
		} else if nums[mid] > target {
			r = mid - 1
		} else if nums[mid] < target {
			l = mid + 1 // mid ä¸ºæœ€åä¸€ä¸ªå°äºçš„ä½ç½®ï¼Œmid + 1 åä¸ºæ’å…¥çš„ä½ç½®
		}
	}
	return l // è¿”å›æ’å…¥ä½ç½®
}
```

`go` è¯­è¨€ `sort.SearchInts()` æºç æ ·ä¾‹ åŸºäºä¸Šä¸€ç§å†™æ³•çš„å˜ç§ï¼Œå› ä¸ºæŸ¥æ‰¾çš„æ˜¯å¤§äºç­‰äºçš„ç´¢å¼•ä½ç½®

1. ä¸´ç•Œæƒ…å†µä¸€ï¼Œ`nums[mid] = target` è¿”å›å·¦åŒºé—´ï¼Œå·¦åŒºé—´ç¬¦åˆ `< target` æ¡ä»¶çš„æœ€å¤§å€¼ `mid`ï¼Œåœ¨æœ€ç»ˆç»“æœç´¢å¼•çš„å·¦è¾¹ï¼Œæ‰€ä»¥ `mid+1` å°±æ˜¯ç»“æœäº†ã€‚
2. ä¸´ç•Œæƒ…å†µäºŒï¼Œ`nums[mid] > target` è¿”å›å·¦åŒºé—´ï¼Œå·¦åŒºé—´ç¬¦åˆ `< target` æ¡ä»¶çš„æœ€å¤§å€¼ `mid`ï¼Œåœ¨æœ€ç»ˆç»“æœæ‰€æœ‰çš„å·¦è¾¹ï¼Œæ‰€ä»¥ `mid+1` å°±æ˜¯ç»“æœäº†

```go
package main

func search(nums []int, target int) int {
	l, r := 0, len(nums)-1
	for l <= r {
		mid := int(uint(l+r) >> 1)
		if nums[mid] < target {
			l = mid + 1
		} else { // å°†ç­‰äºå’Œå¤§äºçš„æƒ…å†µå½’ä¸ºä¸€ç±»
			r = mid - 1
		}
	}
	return l
}
```

å…¶å®ä¸Šè¿°ç¬¦åˆä¸´ç•Œæƒ…å†µçš„ `mid` å°±æ˜¯ç»“æœã€‚

```go
package main

func searchInsert(nums []int, target int) int {
	l, r := 0, len(nums)-1
	ans := len(nums) // æœ€å¤§çš„æ’å…¥ä½ç½®
	for l <= r {
		mid := l + ((r - l) >> 1)
		if nums[mid] >= target {
			ans = mid
			r = mid - 1
		} else if nums[mid] < target {
			l = mid + 1
		}
	}
	return ans // è¿”å›æ’å…¥ä½ç½®
}
```

## å˜ç§ï¼š34åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®

åŸºäº `35` æ¡ˆä¾‹ï¼Œé—®é¢˜å¯ä»¥è§„åˆ’ä¸º

* å¯»æ‰¾æœ€å·¦ç´¢å¼•ï¼šæŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºç­‰äº `target` çš„ä¸‹æ ‡ã€‚
* å¯»æ‰¾æœ€å³ç´¢å¼•ï¼šæŸ¥æ‰¾æœ€åä¸€ä¸ªå°äºç­‰äº `target` çš„ä¸‹æ ‡ã€‚
* æœ€å·¦çš„æƒ…å†µï¼Œå°±æ˜¯å½“ `nums[mid] == target` è¿”å›å·¦åŒºé—´ï¼Œåœ¨å·¦åŒºé—´å¯»æ‰¾åˆ°æœ€åä¸€ä¸ªç¬¦åˆ `< target` çš„ç´¢å¼•ï¼Œç„¶ååŠ  `1`ï¼›
* æœ€å³çš„æƒ…å†µï¼Œå°±æ˜¯å½“ `nums[mid] == target` è¿”å›å³åŒºé—´ï¼Œåœ¨å³åŒºé—´å¯»æ‰¾åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆ `> target` çš„ç´¢å¼•ï¼Œç„¶åå‡ `1`ï¼›

## å˜ç§ï¼š33æœç´¢æ—‹è½¬æ’åºæ•°ç»„

éè¿ç»­é€’å¢æ— é‡å¤çš„æ•°ç»„ï¼Œè€Œæ˜¯é€’å¢æ•°ç»„ç»è¿‡æ—‹è½¬å¾—åˆ°çš„ï¼Œåªæœ‰éƒ¨åˆ†æ•°ç»„æ˜¯æœ‰åºçš„ã€‚ å°†æ•°ç»„ä»ä¸­é—´åˆ†å¼€å·¦å³ä¸¤éƒ¨åˆ†ï¼Œä¸€å®šæœ‰ä¸€éƒ¨åˆ†æ•°ç»„æ˜¯æœ‰åºçš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ†å‰²å‡ºæ¥çš„æœ‰åºæ•°ç»„è¿›è¡Œåˆ¤æ–­ã€‚

âš ï¸ å·¦åŒºé—´åˆ¤æ–­ï¼Œæ˜¯é€šè¿‡ `nums[l] <= nums[mid]`ï¼Œè€Œä¸æ˜¯é€šè¿‡ `target <= nums[mid]`ã€‚

* å·¦åŒºé—´ï¼š`nums[l] <= nums[mid]` å‰éƒ¨åˆ†æœ‰åº
    1. `nums[l] <= target < nums[mid]` ç›®æ ‡å€¼åœ¨å·¦åŒºé—´
    2. `target > nums[mid]`  ç›®æ ‡å€¼åœ¨å³åŒºé—´
* å³åŒºé—´ï¼š
    1. `nums[mid] < target <= nums[r]` ç›®æ ‡å€¼åœ¨å³åŒºé—´
    2. `target < nums[mid]` ç›®æ ‡å€¼åœ¨å·¦åŒºé—´

ğŸ¤” å¦‚ä½•åˆ¤æ–­å·¦å³é‚£éƒ¨åˆ†åŒºé—´æœ‰åºï¼Œ`nums[0] <= nums[mid]` å·¦ä¾§æœ‰åºã€‚

```go
package main

func search(nums []int, target int) int {
	l, r := 0, len(nums)-1
	for l <= r {
		mid := l + ((r - l) >> 1)
		if nums[mid] == target {
			return mid
		}
		if nums[l] <= nums[mid] { // å·¦ä¾§æœ‰åº
			if nums[l] <= target && target < nums[mid] { // ä¸€å®šåœ¨å·¦ä¾§
				r = mid - 1
			} else { // ä¸åœ¨å·¦ä¾§ä»å³ä¾§æ‰¾
				l = mid + 1
			}
		} else {
			if nums[mid] < target && target <= nums[r] {
				l = mid + 1
			} else {
				r = mid - 1
			}
		}
	}
	return -1
}
```

## å˜ç§ï¼š81æœç´¢é€‰æ‹©æ’åºæ•°ç»„II

éè¿ç»­é€’å¢æœ‰é‡å¤çš„æ•°ç»„ï¼Œä¹Ÿæ˜¯é€’å¢æ•°ç»„ç»è¿‡æ—‹è½¬åå¾—åˆ°çš„ã€‚ éœ€è¦è€ƒè™‘çš„è¿˜æ˜¯åˆ¤æ–­å‡ºæ¥æœ‰åºåŒºé—´ï¼Œä½†æ˜¯å­˜åœ¨é‡å¤çš„å€¼ï¼Œå¦‚ `3,1,2,3,3,3,3` è¯¥æ•°ç»„å°±æ²¡åŠæ³•ç›´æ¥åˆ¤æ–­å‡ºæ¥é‚£è¾¹æ˜¯æœ‰åºåŒºé—´ã€‚

* ç¬¬ä¸€ç§æƒ…å†µï¼š
  `10111`ï¼Œ`nums[l] == nums[mid]` æ— æ³•åˆ¤æ–­å‰æœ‰åºè¿˜æ˜¯åæœ‰åºï¼Œæ­¤æ—¶ `l++` å°±å¯ä»¥å»æ‰å¹²æ‰°ï¼Œä¸éœ€è¦æ‰§è¡Œåç»­åˆ¤æ–­é€»è¾‘ `continue`ã€‚
* ç¬¬äºŒç§æƒ…å†µï¼š
  `2345671` `nums[l] < nums[mid]` å‰éƒ¨åˆ†æœ‰åºï¼Œè‹¥ `nums[l] <= target < nums[mid]` åˆ™åœ¨å‰éƒ¨åˆ†æŸ¥æ‰¾ï¼Œå¦åˆ™å°±ååŠéƒ¨åˆ†æ‰¾
* ç¬¬ä¸‰ç§æƒ…å†µï¼š
  `6712345` `nums[l] > nums[mid]` åéƒ¨åˆ†æœ‰åºï¼Œè‹¥ `nums[mid] < target <= nums[r]` åˆ™åœ¨ååŠéƒ¨åˆ†æ‰¾ï¼Œå¦åˆ™å°±å‰åŠéƒ¨åˆ†æ‰¾

```go
package main

func search(nums []int, target int) bool {
	l, r := 0, len(nums)-1
	for l <= r {
		mid := l + ((r - l) >> 1)
		if nums[mid] == target {
			return true
		}
		if nums[l] == nums[mid] {
			l++
			continue // æ³¨æ„éœ€è¦ continue
		}
		if nums[l] <= nums[mid] { // å‰åŠéƒ¨åˆ†æœ‰åº
			if nums[l] <= target && target < nums[mid] {
				r = mid - 1
			} else {
				l = mid + 1
			}
		} else { // åéƒ¨åˆ†æœ‰åº
			if nums[mid] < target && target <= nums[len(nums)-1] {
				l = mid + 1
			} else {
				r = mid - 1
			}
		}
	}
	return false
}
```

## å˜ç§ï¼š153å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼

ä¸‰ç§æƒ…å†µï¼š

1. `nums[mid] < nums[r]` æœ€å°å€¼åœ¨å·¦åŠè¾¹
2. `nums[mid] > nums[r]` æœ€å°å€¼åœ¨å³åŠè¾¹

```go
package main

func findMin(nums []int) int {
	l, r := 0, len(nums)-1
	for l < r { // å·¦é—­å³å¼€åŒºé—´ï¼Œé‡Œé¢å§‹ç»ˆåŒ…å«æœ€å°å€¼ ç»ˆæ­¢æ¡ä»¶ä¸º `left <= mid < right`
		mid := l + ((r - l) >> 1) // å‘ä¸‹å–æ•´æ³• mid æ›´é è¿‘ left
		if nums[mid] < nums[r] {  // æœ€å°å€¼åœ¨å·¦è¾¹, ä¸­å€¼å¯èƒ½æ˜¯æœ€å°å€¼ï¼Œå³è¾¹ç•Œåªèƒ½å–åˆ° mid
			r = mid
		} else if nums[mid] > nums[r] { // æœ€å°å€¼åœ¨å³åŠè¾¹ï¼Œä¸­å€¼è‚¯å®šä¸æ˜¯æœ€å°å€¼ï¼Œå·¦è¾¹ç•Œå¯ä»¥ä¸º mid
			l = mid + 1 // 
		}
	}
	return nums[l] // left == right æœ€å°å€¼éƒ½å¯ä»¥
}
```

`while` é€€å‡ºå¾ªç¯çš„æ¡ä»¶ï¼š

1. æ•°ç»„åªæœ‰ä¸€ä¸ªæ•°ï¼Œå·¦å³è¾¹ç•Œé‡åˆ `left == right` ä¸ä¼šè¿›å…¥å¾ªç¯ï¼›
2. æ•°ç»„å¾ªç¯åˆ°æœ€ååªæœ‰ä¸¤ä¸ªæ•°ï¼Œ`nums[left] == nums[mid]` ä»¥åŠ `nums[right]` è¿™é‡Œ `left == mid == right - 1`ï¼›
    1. è‹¥ `nums[left] == nums[mid] > nums[r]` å·¦å¤§å³å°ï¼Œä¼šæ‰§è¡Œ `l = mid + 1` å·¦å³è¾¹ç•Œé‡åˆå¾ªç¯ç»“æŸï¼›
    2. è‹¥ `nums[left] == nums[mid] < nums[r]` å·¦å°å³å¤§ï¼Œä¼šæ‰§è¡Œ `r = mid` å·¦å³è¾¹ç•Œé‡åˆå¾ªç¯ç»“æŸï¼›